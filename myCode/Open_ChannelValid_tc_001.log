#########################################################################
            Morpho e-Documents
            Riemekestrasse 160
            D-33106 Paderborn
            Phone:  +49 (0) 52 51-889 -0
            Fax:    +49 (0) 52 51-889 -2951
            Internet: http://www.morpho-edocs.com
            Copyright (c) 2003-2011
#########################################################################

               Scenarioname: cardManagement.AmendmentB.ComponentTest.AdminAgent.BipProtocol.Open_ChannelValid

         Testkernel Version: 3.1.3

                 Build Date: 20-March-2014:1451

                  User name: G511284

 Protocol start date + time: Tue Jul 15 14:15:55 CEST 2014

#########################################################################

Using KernelProperty: C:\P4\KUI_SC5OS07\tst\bin\..\config\Testkernel.properties

                                                         ================
                                                         = TESTCASE 001 =
=========================================================================
= SCENARIO cardManagement.AmendmentB.ComponentTest.AdminAgent.BipProtocol.Open_ChannelValid,	TC_ID: 9110
=
= tc_001 send buffer size in Triggering SMS less then 1500 bytes

-------------------------------------------------------------------------
>>>                      PREPARATION OF THE TEST                      <<<
-------------------------------------------------------------------------
counter value = 000000000a
-------------------------------------------------------------------------
>>>                       EXECUTION OF THE TEST                       <<<
-------------------------------------------------------------------------
Open Admin Session

Using IO: com.orga.ute.artifact.card.reader.PcscIO
Using System: com.orga.ute.artifact.card.IsoIO
Cardreader information: Morpho VirtualReader 0: Scp2PCSC v1.2.1      

Using Protocol T=0

ATR:
        <- 3B 97 96 80 1F C7 80 31  E0 73 FE 21 13 B7 


The cardreader does not support a pps request.
>>>>>>>>>> Terminal Profile

Command:   80 10 00 00 3C
Data:      FF FF FF FF FF FF FF FF  FF FF FF FF FF FF FF FF  
           FF FF FF FF FF FF FF FF  FF FF FF FF FF FF FF FF  
           FF FF FF FF FF FF FF FF  FF FF FF FF FF FF FF FF  
           FF FF FF FF FF FF FF FF  FF FF FF FF
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 BE
--

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        BE
Info, using regular expression as expected response! 
Response:  D0 81 BB 81 03 01 25 00  82 02 81 82 85 00 8F 08  
           03 53 69 6D 54 6B 20 31  8F 08 04 53 69 6D 54 6B  
           20 32 8F 0C 1F 50 72 6F  6D 6F 63 69 6F 6E 65 73  
           8F 0C 20 42 61 6E 63 61  20 4D 6F 76 69 6C 8F 09  
           21 4D 69 20 43 6C 61 72  6F 8F 0F 22 52 65 64 65  
           73 20 53 6F 63 69 61 6C  65 73 8F 10 23 52 65 73  
           70 61 6C 64 6F 20 41 67  65 6E 64 61 8F 07 24 4D  
           75 73 69 63 61 8F 07 25  4A 75 65 67 6F 73 8F 0A  
           26 48 6F 72 6F 73 63 6F  70 6F 8F 10 27 54 6F 6E  
           6F 73 20 64 65 20 45 73  70 65 72 61 8F 09 28 44  
           65 70 6F 72 74 65 73 8F  0D 29 41 70 6C 69 63 61  
           63 69 6F 6E 65 73 8F 06  2A 41 79 75 64 61
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--


Proactive command:
SET UP MENU (no help available)
UICC -> Terminal
Alpha-Id: []
03 [SimTk 1]
04 [SimTk 2]
1F [Promociones]
20 [Banca Movil]
21 [Mi Claro]
22 [Redes Sociales]
23 [Respaldo Agenda]
24 [Musica]
25 [Juegos]
26 [Horoscopo]
27 [Tonos de Espera]
28 [Deportes]
29 [Aplicaciones]
2A [Ayuda]

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 0C
Data:      81 03 01 25 00 02 02 82  81 83 01 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 0F
--


SET UP MENU (no help available)
Terminal -> UICC
00 (Command performed successfully)

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        0F
Info, using regular expression as expected response! 
Response:  D0 0D 81 03 01 05 00 82  02 81 82 99 02 09 0A
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--


Proactive command:
SET UP EVENT LIST (RFU)
UICC -> Terminal
Events: Data available, Channel status

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 0C
Data:      81 03 01 05 00 02 02 82  81 83 01 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 0F
--


SET UP EVENT LIST (RFU)
Terminal -> UICC
00 (Command performed successfully)

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        0F
Info, using regular expression as expected response! 
Response:  D0 0D 81 03 01 03 00 82  02 81 82 84 02 01 1E
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--


Proactive command:
POLL INTERVALL (RFU)
UICC -> Terminal
Duration: Seconds, 30 units

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 10
Data:      81 03 01 03 00 02 02 82  81 83 01 00 84 02 01 1E
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--


POLL INTERVALL (RFU)
Terminal -> UICC
00 (Command performed successfully)
Duration: Seconds, 30 units

Push SMS:
SPI1: 12 --> [CC] [NO CIPHER] [CNTR IF HIGHER] 
SPI2: 01 --> [POR] [POR NO RC/CC/DS] [POR NO CIPHER] [SMS DELIVER] 
Ciphering Key Identifier: 15
Signature Key Identifier: 15
Toolkit Application Reference: 380011
Ciphering Key: 0102030405060708
Signature Key: 0102030405060708
Counter: 0000000003
Number of concatenated SMS: 100
Single SMS length: 120
Mactype: 00
------------------------------
ConnectionParameters:
Bearer description: Type=GPRS, Parameter=010101010102
Buffer size=05DCh (1500)
Network access name: 066D6F7270686F03636F6D [morpho.com]
Text: [admin]
Text: [root]
Interface transport level: protocol=TCP, UICC in client mode, port=9096
Other Address: type=IPv4 address, address=80.66.10.152

------------------------------
Security Parameters:
PSK-Identifier: 89390100000129506903
Key Version/Key Identifier: 4001
------------------------------
Retry Policy Parameters:
Retry counter: 0002
Timer value: 00:00:03
------------------------------
HTTP POST Parameters: unknown:
8A1138302E36362E31302E3230303A38303830
8B03303037
8C0B2F4345482F6365686F6370

>>>>>>>>>> Envelope

Command:   80 C2 00 00 AA
Data:      D1 81 A7 02 02 83 81 06  06 00 00 00 00 00 00 0B  
           81 98 40 06 81 14 84 01  7F F6 30 30 32 71 33 35  
           40 88 07 00 03 00 02 01  70 00 00 99 11 12 01 15  
           15 38 00 11 00 00 00 00  03 00 8C E5 34 FF 81 81  
           84 83 81 81 84 35 B5 07  02 01 01 01 01 01 02 B9  
           02 05 DC C7 0B 06 6D 6F  72 70 68 6F 03 63 6F 6D  
           8D 06 04 61 64 6D 69 6E  8D 05 04 72 6F 6F 74 BC  
           03 02 23 88 BE 05 21 50  42 0A 98 85 18 14 38 39  
           33 39 30 31 30 30 30 30  30 31 32 39 35 30 36 39  
           30 33 02 40 01 86 07 00  02 25 03 00 00 30 89 25  
           8A 11 38 30 2E 36 36 2E  31 30
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

SMS-PP download:
Network -> UICC
Address: 0000000000
TPDU: MTI=40, DA=414810 (TON/NPI=81), PID=7F, DCS=F6,
      SCTS=30303271333540, UDL=88, UDHL=07,
      UDH=00030002017000 ->concatenated SMS, 8bit ref Number=0 // SMS 01 of 02. ->SIM Toolkit Security Header ,
      CPL=0099, CHL=11,
      SPI=1201, KIc=15, KID=15, TAR=380011, CNTR=0000000003, PCNTR=00, CRC(or MAC)=8CE534FF,
      8181848381818435B50702010101010102B90205DCC70B066D6F7270686F03636F6D8D060461646D696E8D0504726F6F74BC03022388BE0521
50420A98851814383933393031303030303031323935303639303302400186070002250300003089258A1138302E36362E3130


>>>>>>>>>> Envelope

Command:   80 C2 00 00 41
Data:      D1 3F 02 02 83 81 06 06  00 00 00 00 00 00 0B 31  
           40 06 81 14 84 01 7F F6  30 30 32 71 33 35 40 21  
           05 00 03 00 02 02 2E 32  30 30 3A 38 30 38 30 8B  
           03 30 30 37 8C 0B 2F 43  45 48 2F 63 65 68 6F 63  
           70
Le:        00
SW1_SW2:   61 13
Performing GetResponse

Command:   00 C0 00 00
Data:      
Le:        13
Info, using regular expression as expected response! 
Response:  02 71 00 00 0E 0A 38 00  11 00 00 00 00 03 00 00  
           01 90 00
SW1_SW2:   91 42
--

SMS-PP download:
Network -> UICC
Address: 0000000000
TPDU: MTI=40, DA=414810 (TON/NPI=81), PID=7F, DCS=F6,
      SCTS=30303271333540, UDL=21, UDHL=05,
      UDH=0003000202 ->concatenated SMS, 8bit ref Number=0 // SMS 02 of 02.,
      2E3230303A383038308B033030378C0B2F4345482F6365686F6370


>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        42
Info, using regular expression as expected response! 
Response:  D0 40 81 03 01 40 03 82  02 81 82 05 00 B5 07 02  
           01 01 01 01 01 02 B9 02  05 DC 47 0B 06 6D 6F 72  
           70 68 6F 03 63 6F 6D 0D  06 04 61 64 6D 69 6E 0D  
           05 04 72 6F 6F 74 3C 03  02 23 88 BE 05 21 50 42  
           0A 98
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
OPEN CHANNEL (immediate link establishment, automatic reconnection, no background mode)
UICC -> Terminal
Alpha-Id: []
Bearer description: Type=GPRS, Parameter=010101010102
Buffer size=05DCh (1500)
Network access name: 066D6F7270686F03636F6D [morpho.com]
Text: [admin]
Text: [root]
Interface transport level: protocol=TCP, UICC in client mode, port=9096
Other Address: type=IPv4 address, address=80.66.10.152

verifyOpenChannel: -> passed
>>>>>>>>>> Terminal Response

Command:   80 14 00 00 14
Data:      81 03 01 40 03 02 02 82  81 83 01 00 B8 02 83 00  
           B9 02 05 DC
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 4A
--

>>>>>>>>>> Envelope Channel Status

Command:   80 C2 00 00 0D
Data:      D6 0B 19 01 0A 02 02 82  81 B8 02 83 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 4A
--

Event download:
Event: Channel status
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link established or Packet data service activated,
                      Byte4=No further info can be given

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        4A
Info, using regular expression as expected response! 
Response:  D0 48 81 03 01 43 01 82  02 81 23 05 00 B6 3B 16  
           03 03 00 36 01 00 00 32  03 03 D0 A9 E3 ED 40 85  
           24 6B 08 41 D0 29 8B 62  83 52 2F 5A BB 04 B6 EE  
           0E 4F 61 EF 2E 3B E1 7A  A5 57 00 00 04 00 AE 00  
           B0 01 00 00 05 00 01 00  01 01
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
SEND DATA (send data immediately)
UICC -> Channel 3
Alpha-Id: []
Channel data:
?¥¥@6£@@2¥¥????¡?¤kòA?)?b?R/Z?è??ÅOa?.;?z?W@@è@?@?£@@é@£@££
              [1603030036010000320303D0A9E3ED4085246B0841D0298B6283522F5ABB04B6EE0E4F61EF2E3BE17AA55700000400AE00B001000
0050001000101]

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 0F
Data:      81 03 01 43 01 02 02 82  81 83 01 00 37 01 FF
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

SEND DATA (send data immediately)
Terminal -> UICC
00 (Command performed successfully)
Channel data length: FFh (255)

struct {
  type = handshake;
  version = TLSv1.2;
  struct {
    type = client_hello;
    struct {
      version = TLSv1.2;
      random =
      struct {
        gmt_unix_time = D0A9E3ED;
        random_bytes = 4085246B0841D0298B6283522F5ABB04B6EE0E4F61EF2E3BE17AA557;
      } Random;
      sessionId = <empty>;
      cipherSuites = {
        TLS_PSK_WITH_AES_128_CBC_SHA256
        TLS_PSK_WITH_NULL_SHA256
      };
      compressionMethods = {
        00
      };
      extensions = {
        struct {
          type = max_fragment_length;
          value = 01
        } Extension;
      };
    } ClientHello;
  } Handshake;
} TLSPlaintext;
verifyClientHello: TLSv1.2 Ciphersuites Compression Extensions -> passed
struct {
  type = handshake;
  version = TLSv1.2;
  struct {
    type = server_hello;
    struct {
      version = TLSv1.2;
      random =
      struct {
        gmt_unix_time = 49FECD57;
        random_bytes = 15E044CD99324EB34B6B83DD1D634CDB8E41B0EA3F9EA40AA8163996;
      } Random;
      sessionId = C20982D575DE69A01464536EC174FBD61E9DC8F1505CA681901E6BFADC7CB05B;
      cipherSuite = TLS_PSK_WITH_NULL_SHA256;
      compressionMethod = 00;
      extensions = {
        struct {
          type = max_fragment_length;
          value = 01
        } Extension;
      };
    } ServerHello;
  } Handshake;
} TLSPlaintext;
>>>>>>>>>> Envelope Channel Status

Command:   80 C2 00 00 0D
Data:      D6 0B 19 01 0A 02 02 82  81 B8 02 83 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Event download:
Event: Channel status
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link established or Packet data service activated,
                      Byte4=No further info can be given

>>>>>>>>>> Envelope Data Available

Command:   80 C2 00 00 10
Data:      D6 0E 19 01 09 02 02 82  81 B8 02 43 00 37 01 56
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 10
--

Event download:
Event: Data available
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link not established or Packet data service not activated,
                      Byte4=No further info can be given
Channel data length: 56h (86)

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        10
Info, using regular expression as expected response! 
Response:  D0 0E 81 03 01 42 00 82  02 81 23 05 00 B7 01 56
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
RECEIVE DATA (RFU)
UICC -> Channel 3
Alpha-Id: []
Channel data length: 56h (86)

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 67
Data:      81 03 01 42 00 02 02 82  81 83 01 00 36 56 16 03  
           03 00 51 02 00 00 4D 03  03 49 FE CD 57 15 E0 44  
           CD 99 32 4E B3 4B 6B 83  DD 1D 63 4C DB 8E 41 B0  
           EA 3F 9E A4 0A A8 16 39  96 20 C2 09 82 D5 75 DE  
           69 A0 14 64 53 6E C1 74  FB D6 1E 9D C8 F1 50 5C  
           A6 81 90 1E 6B FA DC 7C  B0 5B 00 B0 00 00 05 00  
           01 00 01 01 37 01 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

RECEIVE DATA (RFU)
Terminal -> UICC
00 (Command performed successfully)
Channel data:
?¥¥@Q$@@M¥¥I??W??D??2N?Kk??æcL??A?????
??9? ?Ç??u?i??dSn?t??ß???PÖ???ßk??ö?Ä@?@@é@£@££
              [16030300510200004D030349FECD5715E044CD99324EB34B6B83DD1D634CDB8E41B0EA3F9EA40AA816399620C20982D575DE69A01
464536EC174FBD61E9DC8F1505CA681901E6BFADC7CB05B00B00000050001000101]
Channel data length: 00

struct {
  type = handshake;
  version = TLSv1.2;
  struct {
    type = server_hello_done;
  } Handshake;
} TLSPlaintext;
>>>>>>>>>> Envelope Channel Status

Command:   80 C2 00 00 0D
Data:      D6 0B 19 01 0A 02 02 82  81 B8 02 83 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Event download:
Event: Channel status
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link established or Packet data service activated,
                      Byte4=No further info can be given

>>>>>>>>>> Envelope Data Available

Command:   80 C2 00 00 10
Data:      D6 0E 19 01 09 02 02 82  81 B8 02 43 00 37 01 09
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 10
--

Event download:
Event: Data available
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link not established or Packet data service not activated,
                      Byte4=No further info can be given
Channel data length: 09

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        10
Info, using regular expression as expected response! 
Response:  D0 0E 81 03 01 42 00 82  02 81 23 05 00 B7 01 09
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
RECEIVE DATA (RFU)
UICC -> Channel 3
Alpha-Id: []
Channel data length: 09

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 1A
Data:      81 03 01 42 00 02 02 82  81 83 01 00 36 09 16 03  
           03 00 04 0E 00 00 00 37  01 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 2E
--

RECEIVE DATA (RFU)
Terminal -> UICC
00 (Command performed successfully)
Channel data:
?¥¥@èÅ@@@
              [16030300040E000000]
Channel data length: 00

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        2E
Info, using regular expression as expected response! 
Response:  D0 2C 81 03 01 43 01 82  02 81 23 05 00 B6 1F 16  
           03 03 00 1A 10 00 00 16  00 14 38 39 33 39 30 31  
           30 30 30 30 30 31 32 39  35 30 36 39 30 33
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
SEND DATA (send data immediately)
UICC -> Channel 3
Alpha-Id: []
Channel data:
?¥¥@??@@?@?89390100000129506903
              [160303001A1000001600143839333930313030303030313239353036393033]

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 0F
Data:      81 03 01 43 01 02 02 82  81 83 01 00 37 01 FF
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 15
--

SEND DATA (send data immediately)
Terminal -> UICC
00 (Command performed successfully)
Channel data length: FFh (255)

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        15
Info, using regular expression as expected response! 
Response:  D0 13 81 03 01 43 01 82  02 81 23 05 00 B6 06 14  
           03 03 00 01 01
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
SEND DATA (send data immediately)
UICC -> Channel 3
Alpha-Id: []
Channel data:
?¥¥@££
              [140303000101]

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 0F
Data:      81 03 01 43 01 02 02 82  81 83 01 00 37 01 FF
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 44
--

SEND DATA (send data immediately)
Terminal -> UICC
00 (Command performed successfully)
Channel data length: FFh (255)

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        44
Info, using regular expression as expected response! 
Response:  D0 42 81 03 01 43 01 82  02 81 23 05 00 B6 35 16  
           03 03 00 30 14 00 00 0C  C3 08 EB DD 48 D7 82 CF  
           EB 4C 9D C0 FA 0F 8A 82  68 75 5F 3D DB B0 05 5D  
           8E 10 1A 6F 76 CC CB 19  67 7F 2D D9 5C 9F 6E F9  
           AC 93 A9 2F
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
SEND DATA (send data immediately)
UICC -> Channel 3
Alpha-Id: []
Channel data:
?¥¥@0?@@ø?ò??H????L???å??hu§=??éÑ???ov???gà-?Ö?n????/
              [16030300301400000CC308EBDD48D782CFEB4C9DC0FA0F8A8268755F3DDBB0055D8E101A6F76CCCB19677F2DD95C9F6EF9AC93A92
F]

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 0F
Data:      81 03 01 43 01 02 02 82  81 83 01 00 37 01 FF
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

SEND DATA (send data immediately)
Terminal -> UICC
00 (Command performed successfully)
Channel data length: FFh (255)

>>>>>>>>>> Envelope Channel Status

Command:   80 C2 00 00 0D
Data:      D6 0B 19 01 0A 02 02 82  81 B8 02 83 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Event download:
Event: Channel status
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link established or Packet data service activated,
                      Byte4=No further info can be given

struct {
  type = handshake;
  version = TLSv1.2;
  struct {
    type = client_key_exchange;
    struct {
      psk_identity = 3839333930313030303030313239353036393033;
    } ClientKeyExchange;
  } Handshake;
} TLSPlaintext;
struct {
  type = change_cipher_spec;
  version = TLSv1.2;
  struct {
    01;
  } ChangeCipherSpec;
} TLSPlaintext;
verified H-MAC -> passed
struct {
  type = handshake;
  version = TLSv1.2;
  struct {
    type = finished;
    struct {
      verifyData = C308EBDD48D782CFEB4C9DC0;
    } Finished;
  } Handshake;
} TLSPlaintext(encrpyted);
verifyClientKeyExchange: PSK Identitiy -> passed
verifyChangeCipherSpec:  Value 0x01 -> passed
verifyFinished: Verify-data -> passed
Master Secret:
struct {
  master_secret = 590407CDA02F0A60F8F56D4D59A0E386C6A25BBCD59530BCB6E86237AA4988F1BC025FE8E076DBBA890768E651879A01;
};
Key Block:
struct {
  client_write_MAC_secret = C4601C7A81F5480E62B4C391EA19BB1BD1346D7B86C109BC1A37CBFB33156175;
  server_write_MAC_secret = 6C6163E7A3A548DE516148D789D70BB5F936A883DF35CDBF9FF699B506265E07;
  client_write_key = ;
  server_write_key = ;
};
struct {
  type = change_cipher_spec;
  version = TLSv1.2;
  struct {
    01;
  } ChangeCipherSpec;
} TLSPlaintext;
>>>>>>>>>> Envelope Channel Status

Command:   80 C2 00 00 0D
Data:      D6 0B 19 01 0A 02 02 82  81 B8 02 83 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Event download:
Event: Channel status
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link established or Packet data service activated,
                      Byte4=No further info can be given

>>>>>>>>>> Envelope Data Available

Command:   80 C2 00 00 10
Data:      D6 0E 19 01 09 02 02 82  81 B8 02 43 00 37 01 06
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 10
--

Event download:
Event: Data available
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link not established or Packet data service not activated,
                      Byte4=No further info can be given
Channel data length: 06

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        10
Info, using regular expression as expected response! 
Response:  D0 0E 81 03 01 42 00 82  02 81 23 05 00 B7 01 06
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
RECEIVE DATA (RFU)
UICC -> Channel 3
Alpha-Id: []
Channel data length: 06

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 17
Data:      81 03 01 42 00 02 02 82  81 83 01 00 36 06 14 03  
           03 00 01 01 37 01 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

RECEIVE DATA (RFU)
Terminal -> UICC
00 (Command performed successfully)
Channel data:
?¥¥@££
              [140303000101]
Channel data length: 00

struct {
  type = handshake;
  version = TLSv1.2;
  struct {
    type = finished;
    struct {
      verifyData = E5C14FEB0369D34600DDF55B;
    } Finished;
  } Handshake;
} TLSPlaintext(encrpyted);
>>>>>>>>>> Envelope Channel Status

Command:   80 C2 00 00 0D
Data:      D6 0B 19 01 0A 02 02 82  81 B8 02 83 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Event download:
Event: Channel status
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link established or Packet data service activated,
                      Byte4=No further info can be given

>>>>>>>>>> Envelope Data Available

Command:   80 C2 00 00 10
Data:      D6 0E 19 01 09 02 02 82  81 B8 02 43 00 37 01 35
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 10
--

Event download:
Event: Data available
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link not established or Packet data service not activated,
                      Byte4=No further info can be given
Channel data length: 35h (53)

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        10
Info, using regular expression as expected response! 
Response:  D0 0E 81 03 01 42 00 82  02 81 23 05 00 B7 01 35
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
RECEIVE DATA (RFU)
UICC -> Channel 3
Alpha-Id: []
Channel data length: 35h (53)

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 46
Data:      81 03 01 42 00 02 02 82  81 83 01 00 36 35 16 03  
           03 00 30 14 00 00 0C E5  C1 4F EB 03 69 D3 46 00  
           DD F5 5B 3F AA 4E AD 6C  3D 9A 6E 75 43 28 57 EB  
           DB 6B CF BA 0B 02 86 E4  EB 41 49 68 67 0F C1 A1  
           D7 9C F8 37 01 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 B2
--

RECEIVE DATA (RFU)
Terminal -> UICC
00 (Command performed successfully)
Channel data:
?¥¥@0?@@ø??O?¥i?F@??Ä??N?l=?nuC(W??k??Ø$???AIhgå?????
              [16030300301400000CE5C14FEB0369D34600DDF55B3FAA4EAD6C3D9A6E75432857EBDB6BCFBA0B0286E4EB414968670FC1A1D79CF
8]
Channel data length: 00

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        B2
Info, using regular expression as expected response! 
Response:  D0 81 AF 81 03 01 43 01  82 02 81 23 05 00 B6 81  
           A1 17 03 03 00 9C 50 4F  53 54 20 2F 43 45 48 2F  
           63 65 68 6F 63 70 20 48  54 54 50 2F 31 2E 31 0D  
           0A 48 6F 73 74 3A 20 38  30 2E 36 36 2E 31 30 2E  
           32 30 30 3A 38 30 38 30  0D 0A 58 2D 41 64 6D 69  
           6E 2D 50 72 6F 74 6F 63  6F 6C 3A 20 67 6C 6F 62  
           61 6C 70 6C 61 74 66 6F  72 6D 2D 72 65 6D 6F 74  
           65 2D 61 64 6D 69 6E 2F  31 2E 30 0D 0A 58 2D 41  
           64 6D 69 6E 2D 46 72 6F  6D 3A 20 30 30 37 0D 0A  
           0D 0A A6 A7 06 2D 1E B3  FB BE F1 ED 88 29 AA CF  
           52 E1 CB 70 32 60 78 19  0E 14 96 84 36 45 BF E9  
           92 9B
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
SEND DATA (send data immediately)
UICC -> Channel 3
Alpha-Id: []
Channel data:
?¥¥@?POST /CEH/cehocp HTTP/1.1Host: 80.66.10.200:8080X-Admin-Protocol: globalplatform-remote-admin/1.0X-Admin-From: 007??ù-ß??????)??R??p2¿x?Å???6E????
              [170303009C504F5354202F4345482F6365686F637020485454502F312E310D0A486F73743A2038302E36362E31302E3230303A383
038300D0A582D41646D696E2D50726F746F636F6C3A20676C6F62616C706C6174666F726D2D72656D6F74652D61646D696E2F312E300D0A582D41646
D696E2D46726F6D3A203030370D0A0D0AA6A7062D1EB3FBBEF1ED8829AACF52E1CB70326078190E1496843645BFE9929B]

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 0F
Data:      81 03 01 43 01 02 02 82  81 83 01 00 37 01 FF
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

SEND DATA (send data immediately)
Terminal -> UICC
00 (Command performed successfully)
Channel data length: FFh (255)

>>>>>>>>>> Envelope Channel Status

Command:   80 C2 00 00 0D
Data:      D6 0B 19 01 0A 02 02 82  81 B8 02 83 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Event download:
Event: Channel status
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link established or Packet data service activated,
                      Byte4=No further info can be given

verified H-MAC -> passed
struct {
  type = application_data;
  version = TLSv1.2;
  application_data = 504F5354202F4345482F6365686F637020485454502F312E310D0A486F73743A2038302E36362E31302E3230303A3830383
00D0A582D41646D696E2D50726F746F636F6C3A20676C6F62616C706C6174666F726D2D72656D6F74652D61646D696E2F312E300D0A582D41646D696
E2D46726F6D3A203030370D0A0D0A
} TLSPlaintext(encrpyted);
HTTP Request:
[POST /CEH/cehocp HTTP/1.1Host: 80.66.10.200:8080X-Admin-Protocol: globalplatform-remote-admin/1.0X-Admin-From: 007]
HTTP Response:
[HTTP/1.1 200 OKX-Admin-Protocol: globalplatform-remote-admin/1.0Content-Type: application/vnd.globalplatform.card-content-mgt;version=1.0X-Admin-Targeted-Application: //aid/D276000028/41070101020002B0002601Content-Length: 12...]
Content-Field HEX:
[A0A40000022FE2A0B0000006]
struct {
  type = application_data;
  version = TLSv1.2;
  application_data = 485454502F312E3120323030204F4B0D0A582D41646D696E2D50726F746F636F6C3A20676C6F62616C706C6174666F726D2
D72656D6F74652D61646D696E2F312E300D0A436F6E74656E742D547970653A206170706C69636174696F6E2F766E642E676C6F62616C706C6174666
F726D2E636172642D636F6E74656E742D6D67743B76657273696F6E3D312E300D0A582D41646D696E2D54617267657465642D4170706C69636174696
F6E3A202F2F6169642F443237363030303032382F343130373031303130323030303242303030323630310D0A436F6E74656E742D4C656E6774683A2
031320D0A0D0AA0A40000022FE2A0B0000006
} TLSPlaintext(encrpyted);
>>>>>>>>>> Envelope Channel Status

Command:   80 C2 00 00 0D
Data:      D6 0B 19 01 0A 02 02 82  81 B8 02 83 00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Event download:
Event: Channel status
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link established or Packet data service activated,
                      Byte4=No further info can be given

>>>>>>>>>> Envelope Data Available

Command:   80 C2 00 00 10
Data:      D6 0E 19 01 09 02 02 82  81 B8 02 43 00 37 01 FF
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 10
--

Event download:
Event: Data available
Terminal -> UICC
Channel status: id=3, Byte3=Packet-Data-Service: Link not established or Packet data service not activated,
                      Byte4=No further info can be given
Channel data length: FFh (255)

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        10
Info, using regular expression as expected response! 
Response:  D0 0E 81 03 01 42 00 82  02 81 23 05 00 B7 01 ED
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
RECEIVE DATA (RFU)
UICC -> Channel 3
Alpha-Id: []
Channel data length: EDh (237)

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 FF
Data:      81 03 01 42 00 02 02 82  81 83 01 00 36 81 ED 17  
           03 03 01 18 48 54 54 50  2F 31 2E 31 20 32 30 30  
           20 4F 4B 0D 0A 58 2D 41  64 6D 69 6E 2D 50 72 6F  
           74 6F 63 6F 6C 3A 20 67  6C 6F 62 61 6C 70 6C 61  
           74 66 6F 72 6D 2D 72 65  6D 6F 74 65 2D 61 64 6D  
           69 6E 2F 31 2E 30 0D 0A  43 6F 6E 74 65 6E 74 2D  
           54 79 70 65 3A 20 61 70  70 6C 69 63 61 74 69 6F  
           6E 2F 76 6E 64 2E 67 6C  6F 62 61 6C 70 6C 61 74  
           66 6F 72 6D 2E 63 61 72  64 2D 63 6F 6E 74 65 6E  
           74 2D 6D 67 74 3B 76 65  72 73 69 6F 6E 3D 31 2E  
           30 0D 0A 58 2D 41 64 6D  69 6E 2D 54 61 72 67 65  
           74 65 64 2D 41 70 70 6C  69 63 61 74 69 6F 6E 3A  
           20 2F 2F 61 69 64 2F 44  32 37 36 30 30 30 30 32  
           38 2F 34 31 30 37 30 31  30 31 30 32 30 30 30 32  
           42 30 30 30 32 36 30 31  0D 0A 43 6F 6E 74 65 6E  
           74 2D 4C 65 6E 67 74 68  3A 20 31 32 37 01 30
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 10
--

RECEIVE DATA (RFU)
Terminal -> UICC
00 (Command performed successfully)
Channel data:
?¥¥£?HTTP/1.1 200 OKX-Admin-Protocol: globalplatform-remote-admin/1.0Content-Type: application/vnd.globalplatform.card-content-mgt;version=1.0X-Admin-Targeted-Application: //aid/D276000028/41070101020002B0002601Content-Length: 12
              [1703030118485454502F312E3120323030204F4B0D0A582D41646D696E2D50726F746F636F6C3A20676C6F62616C706C6174666F7
26D2D72656D6F74652D61646D696E2F312E300D0A436F6E74656E742D547970653A206170706C69636174696F6E2F766E642E676C6F62616C706C617
4666F726D2E636172642D636F6E74656E742D6D67743B76657273696F6E3D312E300D0A582D41646D696E2D54617267657465642D4170706C6963617
4696F6E3A202F2F6169642F443237363030303032382F343130373031303130323030303242303030323630310D0A436F6E74656E742D4C656E67746
83A203132]
Channel data length: 30h (48)

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        10
Info, using regular expression as expected response! 
Response:  D0 0E 81 03 01 42 00 82  02 81 23 05 00 B7 01 30
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
RECEIVE DATA (RFU)
UICC -> Channel 3
Alpha-Id: []
Channel data length: 30h (48)

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 41
Data:      81 03 01 42 00 02 02 82  81 83 01 00 36 30 0D 0A  
           0D 0A A0 A4 00 00 02 2F  E2 A0 B0 00 00 06 6E 74  
           A4 CB B5 B6 44 E9 6F 53  F3 EE EA 6C 8C 2A 93 8B  
           39 90 7A 60 E9 10 61 C1  0E 2A 84 4E 53 AB 37 01  
           00
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 00
--

RECEIVE DATA (RFU)
Terminal -> UICC
00 (Command performed successfully)
Channel data:
??@@$/???@@ùnt????D?oS???l?*??9?z¿??a?Å*?NS?
              [0D0A0D0AA0A40000022FE2A0B00000066E74A4CBB5B644E96F53F3EEEA6C8C2A938B39907A60E91061C10E2A844E53AB]
Channel data length: 00

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        00
Info, using regular expression as expected response! 
Response:  D0 81 FD 81 03 01 43 01  82 02 81 23 05 00 B6 81  
           EF 17 03 03 01 34 50 4F  53 54 20 2F 43 45 48 2F  
           63 65 68 6F 63 70 20 48  54 54 50 2F 31 2E 31 0D  
           0A 48 6F 73 74 3A 20 38  30 2E 36 36 2E 31 30 2E  
           32 30 30 3A 38 30 38 30  0D 0A 58 2D 41 64 6D 69  
           6E 2D 50 72 6F 74 6F 63  6F 6C 3A 20 67 6C 6F 62  
           61 6C 70 6C 61 74 66 6F  72 6D 2D 72 65 6D 6F 74  
           65 2D 61 64 6D 69 6E 2F  31 2E 30 0D 0A 58 2D 41  
           64 6D 69 6E 2D 46 72 6F  6D 3A 20 30 30 37 0D 0A  
           43 6F 6E 74 65 6E 74 2D  54 79 70 65 3A 20 61 70  
           70 6C 69 63 61 74 69 6F  6E 2F 76 6E 64 2E 67 6C  
           6F 62 61 6C 70 6C 61 74  66 6F 72 6D 2E 63 61 72  
           64 2D 63 6F 6E 74 65 6E  74 2D 6D 67 74 2D 72 65  
           73 70 6F 6E 73 65 3B 76  65 72 73 69 6F 6E 3D 31  
           2E 30 0D 0A 54 72 61 6E  73 66 65 72 2D 45 6E 63  
           6F 64 69 6E 67 3A 20 63  68 75 6E 6B 65 64 0D 0A
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
SEND DATA (send data immediately)
UICC -> Channel 3
Alpha-Id: []
Channel data:
?¥¥£4POST /CEH/cehocp HTTP/1.1Host: 80.66.10.200:8080X-Admin-Protocol: globalplatform-remote-admin/1.0X-Admin-From: 007Content-Type: application/vnd.globalplatform.card-content-mgt-response;version=1.0Transfer-Encoding: chunked
              [1703030134504F5354202F4345482F6365686F637020485454502F312E310D0A486F73743A2038302E36362E31302E3230303A383
038300D0A582D41646D696E2D50726F746F636F6C3A20676C6F62616C706C6174666F726D2D72656D6F74652D61646D696E2F312E300D0A582D41646
D696E2D46726F6D3A203030370D0A436F6E74656E742D547970653A206170706C69636174696F6E2F766E642E676C6F62616C706C6174666F726D2E6
36172642D636F6E74656E742D6D67742D726573706F6E73653B76657273696F6E3D312E300D0A5472616E736665722D456E636F64696E673A2063687
56E6B65640D0A]

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 0F
Data:      81 03 01 43 01 02 02 82  81 83 01 00 37 01 FF
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   91 59
--

SEND DATA (send data immediately)
Terminal -> UICC
00 (Command performed successfully)
Channel data length: FFh (255)

>>>>>>>>>> Fetch

Command:   80 12 00 00
Data:      
Le:        59
Info, using regular expression as expected response! 
Response:  D0 57 81 03 01 43 01 82  02 81 23 05 00 B6 4A 58  
           2D 41 64 6D 69 6E 2D 53  63 72 69 70 74 2D 53 74  
           61 74 75 73 3A 20 6F 6B  0D 0A 0D 0A 33 0D 0A 01  
           6E 00 0D 0A 30 0D 0A 0D  0A DC 85 09 3D 05 5B 61  
           26 E6 64 83 D5 86 C5 18  09 0E E9 1B F8 14 2A 9D  
           58 FE F1 8A 15 E3 AE DA  D0
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

Proactive command:
SEND DATA (send data immediately)
UICC -> Channel 3
Alpha-Id: []
Channel data:
X-Admin-Script-Status: ok3£n@0??Ç=éÄa&?d?????ÇÅ???*?X????????
              [582D41646D696E2D5363726970742D5374617475733A206F6B0D0A0D0A330D0A016E000D0A300D0A0D0ADC85093D055B6126E6648
3D586C518090EE91BF8142A9D58FEF18A15E3AEDAD0]

>>>>>>>>>> Terminal Response

Command:   80 14 00 00 0F
Data:      81 03 01 43 01 02 02 82  81 83 01 00 37 01 FF
Le:        00
Info, using regular expression as expected response! 
SW1_SW2:   90 00 (NORMAL_ENDING_OF_THE_COMMAND)
--

SEND DATA (send data immediately)
Terminal -> UICC
00 (Command performed successfully)
Channel data length: FFh (255)

-------------------------------------------------------------------------
>>>                   CLEAR UP THE TESTENVIRONMENT                    <<<
-------------------------------------------------------------------------
 
Summary: 50 Commands of 50 successful executed. 0 Failures
=========================================================================
                                             = SUMMARY for TESTCASE 001 =
                                             ============================
Duration of testcase (in ms): 800


#########################################################################
                  FINAL REPORT: cardManagement.AmendmentB.ComponentTest.AdminAgent.BipProtocol.Open_ChannelValid
#########################################################################
                        Number of testcases: 0001
                       Number of commands: 50
                Number of successful commands: 50


OK 		tc_001	TC-ID: 9110

                       All cases are correct !


         Date + Time: Tue Jul 15 14:15:56 CEST 2014
                    Duration : 00:00:01 
                  User name: G511284

#########################################################################

